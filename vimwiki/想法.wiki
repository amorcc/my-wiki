=== 文件传输流程  ===

==== 上传流程 ====
# 客户端上传前的外部处理。 
  eg：压缩视频，转换格式
# 客户端获取文件的大小等信息 
# 客户端生成文件的hash值，生成guid文件名
# 客户端与服务器通讯，查询该hash值是否已经存在 
# 服务器端判断文件是否存在，若服务器不存在该文件，服务器端与客户端通讯，告诉客户端可以开始传输，转到6，若已经存在，转到15
# 客户端与服务器通讯，约定开始传输
    * 一次传输文件块大小
    * 开始传输的文件块位置
    * 客户端生成的文件hash值
    * 客户端生成的guid文件名
# 开始传输
# 将传输的内容块写入内存缓存
# 批量将缓存内容块写入文件(在此过程中如果服务器端或客户端无法连接，或出错，直接退出并尽可能记录传输进度)
# 直到传输完毕
# 服务器端生成传输文件的hash值，并对hash值进行验证查看文件是否出现错误
# 若hash值出现错误，转入13，否则，转入15
# 服务器端与客户端通讯，告诉客户端文件传输错误
# 客户端文件出错处理
# 服务器端与客户端通讯，告诉客户端文件传输成功
# 客户端调用传输完成的外部处理
# 结束传输，断开连接
# 若传输过程中，客户端主动断开，客户端告诉服务器端保存本次传输进度，客户端同样保存进度，下次续传

==== 断点续传 ====
# 客户端获取文件的大小等信息 
# 客户端生成文件的hash值，生成guid文件名
# 服务器端判断文件是否已经存在，若不存在(指传输完成且成功的文件)，转入下一步，否则
# 服务器端查找上次传输的文件块,若不存在，转入下一步
# 服务器端告诉客户端上次传输文件丢失
# 客户端设定文件重新上传，开始传输位置为0
# 客户端与服务器通讯，约定开始传输
    * 一次传输的文件块位置
    * 开始传输的文件块位置
    * 客户端生成的文件hash值 
    * 客户端生成的guid文件名
# 开始传输 
# 将传输的内容块写入内存缓存
# 批量将缓存内容块写入文件(在此过程中如果服务器端或客户端无法连接，或出错，直接退出并尽可能记录传输进度)
# 直到传输完毕
# 服务器端生成传输文件的hash值，并对hash值进行验证查看文件是否出现错误
# 若hash值出现错误，转入14，否则，转入16
# 服务器端与客户端通讯，告诉客户端文件传输错误
# 客户端文件出错处理
# 服务器端与客户端通讯，告诉客户端文件传输成功
# 客户端调用传输完成的外部处理
# 结束传输，断开连接
# 若传输过程中，客户端主动断开，客户端告诉服务器端保存本次传输进度，客户端同样保存进度，下次续传

# 
# 
